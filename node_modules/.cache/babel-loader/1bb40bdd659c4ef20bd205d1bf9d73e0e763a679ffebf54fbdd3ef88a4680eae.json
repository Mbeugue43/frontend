{"ast":null,"code":"const BASE_URL = process.env.REACT_APP_API_BASE_URL || \"http://localhost:5000/api\";\n\n// =================== TOKEN MANAGEMENT ===================\nexport const TOKEN_KEY = \"token\"; // ← CHANGÉ \"authToken\" → \"token\"\n\nexport const getAuthToken = () => localStorage.getItem(TOKEN_KEY);\nexport const setAuthToken = token => localStorage.setItem(TOKEN_KEY, token);\nexport const removeAuthToken = () => localStorage.removeItem(TOKEN_KEY);\nexport const decodeToken = token => {\n  if (!token) return null;\n  try {\n    return JSON.parse(atob(token.split('.')[1]));\n  } catch {\n    return null;\n  }\n};\n\n// Fonction pour vérifier si un token JWT est valide (non expiré)\nexport const isTokenValid = token => {\n  if (!token) return false;\n  try {\n    const decoded = decodeToken(token);\n    if (!decoded || !decoded.exp) return false;\n    // Vérifier si le token n'est pas expiré (exp est en secondes, Date.now() en millisecondes)\n    return decoded.exp * 1000 > Date.now();\n  } catch {\n    return false;\n  }\n};\n\n// =================== API FUNCTIONS ===================\nconst getData = async endpoint => {\n  try {\n    const token = getAuthToken();\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    if (token) {\n      headers.Authorization = `Bearer ${token}`;\n    }\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\n    const response = await fetch(url, {\n      headers\n    });\n    if (!response.ok) {\n      // Si 401, le token est invalide ou expiré\n      if (response.status === 401) {\n        removeAuthToken();\n        // Rediriger vers login si on est dans le navigateur\n        if (typeof window !== 'undefined' && window.location.pathname !== '/login') {\n          window.location.href = '/login';\n        }\n        throw new Error('Session expirée. Veuillez vous reconnecter.');\n      }\n      const errorData = await response.json().catch(() => ({\n        message: `Erreur ${response.status}`\n      }));\n      throw new Error(errorData.message || `Erreur ${response.status}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error(\"Error fetching data:\", error);\n    throw error;\n  }\n};\nconst postData = async (endpoint, payload) => {\n  try {\n    const token = getAuthToken();\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    if (token) headers.Authorization = `Bearer ${token}`;\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers,\n      body: JSON.stringify(payload)\n    });\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({\n        message: `Erreur ${response.status}`\n      }));\n      throw new Error(errorData.message || `Erreur ${response.status}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error(\"Error posting data:\", error);\n    throw error;\n  }\n};\n\n// Fonction PUT pour mettre à jour des données\nconst putData = async (endpoint, payload) => {\n  try {\n    const token = getAuthToken();\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    if (token) headers.Authorization = `Bearer ${token}`;\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\n    const response = await fetch(url, {\n      method: \"PUT\",\n      headers,\n      body: JSON.stringify(payload)\n    });\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({\n        message: `Erreur ${response.status}`\n      }));\n      throw new Error(errorData.message || `Erreur ${response.status}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error(\"Error updating data:\", error);\n    throw error;\n  }\n};\n\n// Fonction DELETE pour supprimer des données\nconst deleteData = async endpoint => {\n  try {\n    const token = getAuthToken();\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    if (token) headers.Authorization = `Bearer ${token}`;\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\n    const response = await fetch(url, {\n      method: \"DELETE\",\n      headers\n    });\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({\n        message: `Erreur ${response.status}`\n      }));\n      throw new Error(errorData.message || `Erreur ${response.status}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error(\"Error deleting data:\", error);\n    throw error;\n  }\n};\n\n// =================== EXPORTS ===================\nexport { postData, putData, deleteData };\nexport default getData;","map":{"version":3,"names":["BASE_URL","process","env","REACT_APP_API_BASE_URL","TOKEN_KEY","getAuthToken","localStorage","getItem","setAuthToken","token","setItem","removeAuthToken","removeItem","decodeToken","JSON","parse","atob","split","isTokenValid","decoded","exp","Date","now","getData","endpoint","headers","Authorization","url","startsWith","response","fetch","ok","status","window","location","pathname","href","Error","errorData","json","catch","message","error","console","postData","payload","method","body","stringify","putData","deleteData"],"sources":["C:/Users/mbeug/OneDrive/Desktop/GOVAIMED1/frontend/govaimed_frontend/src/api/endpoint.js"],"sourcesContent":["const BASE_URL = process.env.REACT_APP_API_BASE_URL || \"http://localhost:5000/api\";\r\n\r\n// =================== TOKEN MANAGEMENT ===================\r\nexport const TOKEN_KEY = \"token\";  // ← CHANGÉ \"authToken\" → \"token\"\r\n\r\nexport const getAuthToken = () => localStorage.getItem(TOKEN_KEY);\r\nexport const setAuthToken = (token) => localStorage.setItem(TOKEN_KEY, token);\r\nexport const removeAuthToken = () => localStorage.removeItem(TOKEN_KEY);\r\n\r\nexport const decodeToken = (token) => {\r\n  if (!token) return null;\r\n  try {\r\n    return JSON.parse(atob(token.split('.')[1]));\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n\r\n// Fonction pour vérifier si un token JWT est valide (non expiré)\r\nexport const isTokenValid = (token) => {\r\n  if (!token) return false;\r\n  try {\r\n    const decoded = decodeToken(token);\r\n    if (!decoded || !decoded.exp) return false;\r\n    // Vérifier si le token n'est pas expiré (exp est en secondes, Date.now() en millisecondes)\r\n    return decoded.exp * 1000 > Date.now();\r\n  } catch {\r\n    return false;\r\n  }\r\n};\r\n\r\n// =================== API FUNCTIONS ===================\r\nconst getData = async (endpoint) => {\r\n  try {\r\n    const token = getAuthToken();\r\n    const headers = { 'Content-Type': 'application/json' };\r\n    if (token) {\r\n      headers.Authorization = `Bearer ${token}`;\r\n    }\r\n\r\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\r\n    const response = await fetch(url, { headers });\r\n    \r\n    if (!response.ok) {\r\n      // Si 401, le token est invalide ou expiré\r\n      if (response.status === 401) {\r\n        removeAuthToken();\r\n        // Rediriger vers login si on est dans le navigateur\r\n        if (typeof window !== 'undefined' && window.location.pathname !== '/login') {\r\n          window.location.href = '/login';\r\n        }\r\n        throw new Error('Session expirée. Veuillez vous reconnecter.');\r\n      }\r\n      const errorData = await response.json().catch(() => ({ message: `Erreur ${response.status}` }));\r\n      throw new Error(errorData.message || `Erreur ${response.status}`);\r\n    }\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error(\"Error fetching data:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst postData = async (endpoint, payload) => {\r\n  try {\r\n    const token = getAuthToken();\r\n    const headers = { 'Content-Type': 'application/json' };\r\n    if (token) headers.Authorization = `Bearer ${token}`;\r\n\r\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      headers,\r\n      body: JSON.stringify(payload),\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({ message: `Erreur ${response.status}` }));\r\n      throw new Error(errorData.message || `Erreur ${response.status}`);\r\n    }\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error(\"Error posting data:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Fonction PUT pour mettre à jour des données\r\nconst putData = async (endpoint, payload) => {\r\n  try {\r\n    const token = getAuthToken();\r\n    const headers = { 'Content-Type': 'application/json' };\r\n    if (token) headers.Authorization = `Bearer ${token}`;\r\n\r\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\r\n    const response = await fetch(url, {\r\n      method: \"PUT\",\r\n      headers,\r\n      body: JSON.stringify(payload),\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({ message: `Erreur ${response.status}` }));\r\n      throw new Error(errorData.message || `Erreur ${response.status}`);\r\n    }\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error(\"Error updating data:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Fonction DELETE pour supprimer des données\r\nconst deleteData = async (endpoint) => {\r\n  try {\r\n    const token = getAuthToken();\r\n    const headers = { 'Content-Type': 'application/json' };\r\n    if (token) headers.Authorization = `Bearer ${token}`;\r\n\r\n    const url = endpoint.startsWith('/') ? `${BASE_URL}${endpoint}` : `${BASE_URL}/${endpoint}`;\r\n    const response = await fetch(url, {\r\n      method: \"DELETE\",\r\n      headers,\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({ message: `Erreur ${response.status}` }));\r\n      throw new Error(errorData.message || `Erreur ${response.status}`);\r\n    }\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error(\"Error deleting data:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// =================== EXPORTS ===================\r\nexport { postData, putData, deleteData };\r\nexport default getData;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}